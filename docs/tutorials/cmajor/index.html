<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <title>Using Faust in Cmajor - Faust Documentation
    </title>
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="/css/quickref.css" rel="stylesheet">
    <link href="/css/github.min.css" rel="stylesheet">
    <link href="/rail/railroad-diagrams.css" rel="stylesheet">
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <script src="../../js/bootstrap.min.js" defer></script>
    <script src="../../js/MathJax-2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"defer></script>
    <script src="../../js/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
    <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="../.."><img
                    src="../../img/faustText.svg" width="150px"> </a>
            <!-- Expander button -->
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Expanded navigation -->
            <div id="navbar-collapse" class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="navitem">
                        <a href="../.." class="nav-link">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Manual <b
                                class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li>
    <a href="../../manual/introduction/" class="dropdown-item">Introduction</a>
</li>
                            
<li>
    <a href="../../manual/overview/" class="dropdown-item">Overview of the Faust Universe</a>
</li>
                            
<li>
    <a href="../../manual/quick-start/" class="dropdown-item">Quick Start</a>
</li>
                            
<li>
    <a href="../../manual/syntax/" class="dropdown-item">Faust Syntax</a>
</li>
                            
<li>
    <a href="../../manual/errors/" class="dropdown-item">Error Messages</a>
</li>
                            
<li>
    <a href="../../manual/compiler/" class="dropdown-item">Using the Compiler</a>
</li>
                            
<li>
    <a href="../../manual/options/" class="dropdown-item">Compiler Options</a>
</li>
                            
<li>
    <a href="../../manual/tools/" class="dropdown-item">faust2[...] Tools</a>
</li>
                            
<li>
    <a href="../../manual/architectures/" class="dropdown-item">Architecture Files</a>
</li>
                            
<li>
    <a href="../../manual/embedding/" class="dropdown-item">Embedding the Compiler</a>
</li>
                            
<li>
    <a href="../../manual/optimizing/" class="dropdown-item">Optimizing the Code</a>
</li>
                            
<li>
    <a href="../../manual/debugging/" class="dropdown-item">Debugging the Code</a>
</li>
                            
<li>
    <a href="../../manual/deploying/" class="dropdown-item">Deploying on the Web</a>
</li>
                            
<li>
    <a href="../../manual/remote/" class="dropdown-item">Remote Compilation</a>
</li>
                            
<li>
    <a href="../../manual/mathdoc/" class="dropdown-item">Mathematical Documentation</a>
</li>
                            
<li>
    <a href="../../manual/osc/" class="dropdown-item">OSC Support</a>
</li>
                            
<li>
    <a href="../../manual/http/" class="dropdown-item">HTTP Support</a>
</li>
                            
<li>
    <a href="../../manual/midi/" class="dropdown-item">MIDI Support</a>
</li>
                            
<li>
    <a href="../../manual/soundfiles/" class="dropdown-item">Soundfiles Support</a>
</li>
                            
<li>
    <a href="../../manual/community/" class="dropdown-item">Community</a>
</li>
                            
<li>
    <a href="../../manual/faq/" class="dropdown-item">Frequently Asked Questions</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Examples <b
                                class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li>
    <a href="../../examples/ambisonics/" class="dropdown-item"> ambisonics </a>
</li>
                            
<li>
    <a href="../../examples/analysis/" class="dropdown-item"> analysis </a>
</li>
                            
<li>
    <a href="../../examples/bela/" class="dropdown-item"> bela </a>
</li>
                            
<li>
    <a href="../../examples/delayEcho/" class="dropdown-item"> delayEcho </a>
</li>
                            
<li>
    <a href="../../examples/dynamic/" class="dropdown-item"> dynamic </a>
</li>
                            
<li>
    <a href="../../examples/filtering/" class="dropdown-item"> filtering </a>
</li>
                            
<li>
    <a href="../../examples/gameaudio/" class="dropdown-item"> gameaudio </a>
</li>
                            
<li>
    <a href="../../examples/generator/" class="dropdown-item"> generator </a>
</li>
                            
<li>
    <a href="../../examples/misc/" class="dropdown-item"> misc </a>
</li>
                            
<li>
    <a href="../../examples/phasing/" class="dropdown-item"> phasing </a>
</li>
                            
<li>
    <a href="../../examples/physicalModeling/" class="dropdown-item"> physicalModeling </a>
</li>
                            
<li>
    <a href="../../examples/pitchShifting/" class="dropdown-item"> pitchShifting </a>
</li>
                            
<li>
    <a href="../../examples/psychoacoustic/" class="dropdown-item"> psychoacoustic </a>
</li>
                            
<li>
    <a href="../../examples/reverb/" class="dropdown-item"> reverb </a>
</li>
                            
<li>
    <a href="../../examples/SAM/" class="dropdown-item"> SAM </a>
</li>
                            
<li>
    <a href="../../examples/smartKeyboard/" class="dropdown-item"> smartKeyboard </a>
</li>
                            
<li>
    <a href="../../examples/spat/" class="dropdown-item"> spat </a>
</li>
                            
<li>
    <a href="../../rsrc/examples.zip" class="dropdown-item"> Download examples </a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Tutorials <b
                                class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li>
    <a href="../../workshops/2020-04-10-faust-juce/" class="dropdown-item">Faust & JUCE</a>
</li>
                            
<li>
    <a href="../teensy/" class="dropdown-item">DSP on the Teensy With Faust</a>
</li>
                            
<li>
    <a href="../esp32/" class="dropdown-item">DSP on the ESP-32 With Faust</a>
</li>
                            
<li>
    <a href="../basic-osc/" class="dropdown-item">Making a Sine Oscillator From Scratch</a>
</li>
                            
<li>
    <a href="../summation/" class="dropdown-item">RMS and Summation in Faust</a>
</li>
                            
<li>
    <a href="../box-api/" class="dropdown-item">Using the box API</a>
</li>
                            
<li>
    <a href="../signal-api/" class="dropdown-item">Using the signal API</a>
</li>
                            
<li>
    <a href="../julia/" class="dropdown-item">Using Faust in Julia</a>
</li>
                            
<li>
    <a href="./" class="dropdown-item active">Using Faust in Cmajor</a>
</li>
                            
<li>
    <a href="../jsfx/" class="dropdown-item">Using Faust in JSFX</a>
</li>
                            
<li>
    <a href="../rnbo/" class="dropdown-item">Using Faust in RNBO with codebox~</a>
</li>
                            
<li>
    <a href="../debugging/" class="dropdown-item">Advanced debugging with interp-tracer</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Workshops <b
                                class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li>
    <a href="../../workshops/2018-12-01-paw/" class="dropdown-item"> 2018-12-01 PAW </a>
</li>
                            
<li>
    <a href="../../workshops/2020-03-24-faust-citi/" class="dropdown-item"> 2020-03-24 CITI </a>
</li>
                            
<li>
    <a href="../../workshops/2020-04-10-faust-101/" class="dropdown-item"> 2020-04-10 Faust 101 </a>
</li>
                            
<li>
    <a href="../../workshops/2020-04-10-faust-juce/" class="dropdown-item"> 2020-04-10 Faust & JUCE </a>
</li>
                            
<li>
    <a href="../../workshops/2020-11-21-faust-vcvrack/" class="dropdown-item"> 2020-11-21 Faust & VCV Rack </a>
</li>
                        </ul>
                    </li>
                    <li class="navitem">
                        <a href="../../about/" class="nav-link">About</a>
                    </li>
                </ul>

                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    

    <div class="container">
        <div class="row"><div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#using-faust-in-cmajor" class="nav-link">Using Faust in Cmajor</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#who-is-this-tutorial-for" class="nav-link">Who is this tutorial for?</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#installing-the-required-packages" class="nav-link">Installing the required packages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#using-command-line-tools" class="nav-link">Using command line tools</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#generating-cmajor-code" class="nav-link">Generating Cmajor code</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#looking-at-the-generated-code" class="nav-link">Looking at the generated code</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#using-the-faust2cmajor-tool" class="nav-link">Using the faust2cmajor tool</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#generating-the-cmajor-output-using-faustremote" class="nav-link">Generating the Cmajor output using faustremote</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#using-the-faust-web-ide" class="nav-link">Using the Faust Web IDE</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#generating-the-cmajor-output" class="nav-link">Generating the Cmajor output</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#generating-the-cmajor-output-in-polyphonic-mode" class="nav-link">Generating the Cmajor output in polyphonic mode</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#generating-the-cmajor-output-in-polyphonic-mode-with-a-global-effect" class="nav-link">Generating the Cmajor output in polyphonic mode with a global effect</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#generating-the-cmajor-output-from-a-faust-dsp-program-found-in-the-web" class="nav-link">Generating the Cmajor output from a Faust DSP program found in the web</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#experimental-faust-in-cmajor-integration" class="nav-link">Experimental Faust in Cmajor integration</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#known-limitations" class="nav-link">Known limitations</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
            <div class="col-md-9 main-container" role="main">

<h1 id="using-faust-in-cmajor">Using Faust in Cmajor</h1>
<p>In this tutorial, we present how <a href="https://faust.grame.fr">Faust</a> can be used with <a href="https://cmajor.dev">Cmajor</a>, a C like procedural high-performance language especially designed for audio processing, and with dynamic JIT based compilation. Compiling Faust DSP to cmajor code will allow to take profit of hundreds of DSP building blocks implemented in the <a href="https://faustlibraries.grame.fr">Faust Libraries</a>, ready to use <a href="../../examples/ambisonics/">Examples</a>, any DSP program developed in more than 200 projects listed in the <a href="https://faust.grame.fr/community/powered-by-faust/">Powered By Faust</a> page, or Faust DSP programs found on the net.</p>
<h4 id="who-is-this-tutorial-for">Who is this tutorial for?</h4>
<p>The <a href="#using-command-line-tools">first section</a> assumes a working <a href="https://github.com/grame-cncm/faust">Faust</a> compiler installed on the machine, so is more designed for regular Faust users. The <a href="#using-the-faust-web-ide">second section</a> is better suited for Cmajor users who want to discover Faust.  </p>
<h4 id="installing-the-required-packages">Installing the required packages</h4>
<p>Download the <a href="https://github.com/SoundStacks/cmajor/releases"><strong>cmaj</strong> package</a> and install to have it in your PATH. </p>
<h2 id="using-command-line-tools">Using command line tools</h2>
<h3 id="generating-cmajor-code">Generating Cmajor code</h3>
<p>Assuming you've <a href="https://faust.grame.fr/downloads/">installed the <strong>faust</strong> compiler</a>, starting from the following DSP <strong>osc.dsp</strong> program:</p>
<!-- faust-run -->
<div class="faust-run"><img src="exfaust0/exfaust0.svg" class="mx-auto d-block">
<faust-editor><!--

import("stdfaust.lib");

vol = hslider("volume [unit:dB]", 0, -96, 0, 0.1) : ba.db2linear : si.smoo;
freq1 = hslider("freq1 [unit:Hz]", 1000, 20, 3000, 1);
freq2 = hslider("freq2 [unit:Hz]", 200, 20, 3000, 1);

process = vgroup("Oscillator", os.osc(freq1) * vol, os.osc(freq2) * vol);

--></faust-editor>
<br>
</div>
<!-- /faust-run -->

<p>The Cmajor code can be generated using:</p>
<pre><code class="language-bash">faust -lang cmajor osc.dsp -o osc.cmajor
</code></pre>
<p>This will generate a <code>mydsp</code> processor included in a namespace <code>faust {...}</code> with a set of methods to manipulate it. This API basically mimics the <a href="https://github.com/grame-cncm/faust/blob/master-dev/architecture/faust/dsp/dsp.h">one defined for the C++ backend</a>. </p>
<h3 id="looking-at-the-generated-code">Looking at the generated code</h3>
<p>The generated code contains <code>input event</code> definition for the three sliders defined in the DSP source code:</p>
<pre><code>input event float32 eventfHslider1 [[ name: &quot;freq1&quot;, group: &quot;/v:Oscillator/freq1&quot;, min: 20.0f, max: 3000.0f, init: 1000.0f, step: 1.0f, meta_unit0: &quot;Hz&quot; ]];
input event float32 eventfHslider2 [[ name: &quot;freq2&quot;, group: &quot;/v:Oscillator/freq2&quot;, min: 20.0f, max: 3000.0f, init: 200.0f, step: 1.0f, meta_unit1: &quot;Hz&quot; ]];
input event float32 eventfHslider0 [[ name: &quot;volume&quot;, group: &quot;/v:Oscillator/volume&quot;, min: 0.0f, max: 1.0f, init: 0.5f, step: 0.01f ]];
</code></pre>
<p>The needed <code>main</code> function executes the DSP sample generation code:</p>
<pre><code>void main()
{
    // DSP loop running forever...
    loop
    {
        if (fUpdated) { fUpdated = false; control(); }

        // Computes one sample
        fRec1[0] = fControl[1] + fRec1[1] - floor (fControl[1] + fRec1[1]);
        output0 &lt;- float32 (fControl[0] * ftbl0mydspSIG0.at (int32 (65536.0f * fRec1[0])));
        fRec2[0] = fControl[2] + fRec2[1] - floor (fControl[2] + fRec2[1]);
        output1 &lt;- float32 (fControl[0] * ftbl0mydspSIG0.at (int32 (65536.0f * fRec2[0])));
        fRec1[1] = fRec1[0];
        fRec2[1] = fRec2[0];

        // Moves all streams forward by one 'tick'
        advance();
    }
}
</code></pre>
<p>Note that the generated code uses the so-called <a href="../../manual/compiler/#structure-of-the-generated-code">scalar code generation model</a>, the default one, where the compiled sample generation code is inlined on the Cmajor <code>loop</code> block. </p>
<p>We cannot directly play the generated <code>osc.cmajor</code> file since the <strong>cmaj</strong> program expects a <code>osc.cmajorpatch</code> to execute. A simple solution is to use the following command:</p>
<pre><code class="language-bash">cmaj create --name=osc osc 
</code></pre>
<p>to create an  <code>osc</code>  folder with default  <code>osc.cmajor</code> and <code>osc.cmajorpatch</code> files. Then using the command:</p>
<pre><code class="language-bash">faust -lang cmajor osc.dsp -o osc/osc.cmajor
</code></pre>
<p>allows to simply replace the default <code>osc.cmajor</code> with our own Faust generated version.</p>
<p>The patchfile can now be compiled and executed using the <strong>cmaj</strong> program:</p>
<pre><code class="language-bash">cmaj play osc/osc.cmajorpatch
</code></pre>
<p>The three declared sliders are automatically created and can be used to change the two channels frequencies and their volume.</p>
<p>The Cmajor processor code can directly be used in a more complex Cmajor program, possibly connected to other Faust generated or Cmajor hand-written processors. Note that the generated processor name can simply be changed using the Faust compiler <code>-cn &lt;name&gt;</code> option, so that several Faust generated processors can be distinguished by their names:</p>
<pre><code class="language-bash">faust -lang cmajor -cn osc osc.dsp -o osc/osc.cmajor
</code></pre>
<h3 id="using-the-faust2cmajor-tool">Using the faust2cmajor tool</h3>
<p>The <a href="https://github.com/grame-cncm/faust/tree/master-dev/architecture/cmajor#faust2cmajor">faust2cmajor</a> tool allows to automate calling the Faust compiler with the right options and interacting with the <strong>cmaj</strong> program:</p>
<pre><code class="language-bash">faust2cmajor -h
Usage: faust2cmajor [options] [Faust options] &lt;file.dsp&gt;
Compiles Faust programs to Cmajor
Options:
-midi : activates MIDI control
-nvoices &lt;num&gt; : produces a polyphonic DSP with &lt;num&gt; voices, ready to be used with MIDI events
-effect &lt;effect.dsp&gt; : generates a polyphonic DSP connected to a global output effect, ready to be used with MIDI or OSC
-effect auto : generates a polyphonic DSP connected to a global output effect defined as 'effect' in &lt;file.dsp&gt;, ready to be used with MIDI or OSC
-juce : to create a JUCE project
-dsp : to create a 'dsp' compatible subclass
-play : to start the 'cmaj' runtime with the generated Cmajor file
Faust options : any option (e.g. -vec -vs 8...). See the Faust compiler documentation.
</code></pre>
<p>So the following command:</p>
<pre><code class="language-bash">faust2cmajor -play osc.dsp 
</code></pre>
<p>will directly compile the <code>osc.dsp</code> file, generate the <code>osc.cmajor</code> and <code>osc.cmajorpatch</code> files:</p>
<pre><code>{
    &quot;CmajorVersion&quot;: 1,
    &quot;ID&quot;: &quot;grame.cmajor.osc&quot;,
    &quot;version&quot;: &quot;1.0&quot;,
    &quot;name&quot;: &quot;osc&quot;,
    &quot;description&quot;: &quot;Cmajor example&quot;,
    &quot;category&quot;: &quot;synth&quot;,
    &quot;manufacturer&quot;: &quot;GRAME&quot;,
    &quot;website&quot;: &quot;https://faust.grame.fr&quot;,
    &quot;isInstrument&quot;: false,
    &quot;source&quot;: &quot;osc.cmajor&quot;
}
</code></pre>
<p>And activate the <strong>cmaj</strong> program to run the processor. </p>
<p>The following <a href="../../manual/midi/#midi-polyphony-support">polyphonic ready instrument</a> DSP can be converted to a MIDI ready cmajor instrument:</p>
<!-- faust-run -->
<div class="faust-run"><img src="exfaust1/exfaust1.svg" class="mx-auto d-block">
<faust-editor><!--

declare options "[midi:on][nvoices:8]";
import("stdfaust.lib");
process = organ <: _,_
with {
    decimalpart(x) = x-int(x);
    phasor(f) = f/ma.SR : (+ : decimalpart) ~ _;
    osc(f) = sin(2 * ma.PI * phasor(f));
    freq = nentry("freq", 100, 100, 3000, 0.01);
    gate = button("gate");
    gain = nentry("gain", 0.5, 0, 1, 0.01);
    organ = en.adsr(0.1, 0.1, 0.7, 0.25, gate) * (osc(freq) * gain + osc(2*freq)*0.5 * gain);
};


--></faust-editor>
<br>
</div>
<!-- /faust-run -->

<p>The following command then opens the <strong>cmaj</strong> program and MDI events can be sent to control the instrument:</p>
<pre><code class="language-bash">faust2cmajor -play -midi -nvoices 16 organ.dsp 
</code></pre>
<p>Note that the generated GUI is empty, since the generated processor cannot automatically reflects its controls in the main graph.</p>
<p>The following polyphonic ready instrument DSP, with an <a href="../../manual/midi/#audio-effects-and-polyphonic-synthesizer">integrated effect</a>, can be converted to a MIDI ready cmajor instrument:</p>
<!-- faust-run -->
<div class="faust-run"><img src="exfaust2/exfaust2.svg" class="mx-auto d-block">
<faust-editor><!--

declare options "[midi:on][nvoices:8]";
import("stdfaust.lib");
process = pm.clarinet_ui_MIDI <: _,_;
effect = dm.freeverb_demo;

--></faust-editor>
<br>
</div>
<!-- /faust-run -->

<p>The following command then opens the <strong>cmaj</strong> program and MDI events can be sent to control the instrument:</p>
<pre><code class="language-bash">faust2cmajor -play -midi -nvoices 16 -effect auto clarinet.dsp 
</code></pre>
<p>Here again the generated GUI is empty.</p>
<h3 id="generating-the-cmajor-output-using-faustremote">Generating the Cmajor output using faustremote</h3>
<p>A possibility is to use the <a href="../../manual/remote/">faustremote</a> script to convert a local DSP with the following commands:</p>
<pre><code class="language-bash">faustremote cmajor cmajor foo.dsp
unzip binary.zip
</code></pre>
<h2 id="using-the-faust-web-ide">Using the Faust Web IDE</h2>
<p>Faust DSP program can be written, tested in the <a href="https://faustide.grame.fr/">Faust Web IDE</a> and generated as embeddable Cmajor code.</p>
<h3 id="generating-the-cmajor-output">Generating the Cmajor output</h3>
<p>The output as a Cmajor program can directly be generated using the <em>Platform = cmajor</em> and <em>Architecture = cmajor</em> export options. The resulting <em>foo</em> folder is self-contained, containing the <code>foo.cmajor</code> and <code>foo.cmajorpatch</code> files. The program can be executed using <code>cmaj play foo/foo.cmajorpatch</code> command or possibly <a href="https://github.com/SoundStacks/cmajor/blob/main/docs/Cmaj%20Quick%20Start.md">converted as a JUCE plugin</a>.</p>
<p><img src="img/export.png" class="mx-auto d-block" width="40%">
<center><em>Exporting the code</em></center></p>
<h3 id="generating-the-cmajor-output-in-polyphonic-mode">Generating the Cmajor output in polyphonic mode</h3>
<p>DSP programs following the polyphonic <a href="../../manual/midi/#midi-polyphony-support">freq/gate/gain convention</a> can be generated using the <em>Platform = cmajor</em> and <em>Architecture = cmajor-poly</em> export options. The resulting <em>foo</em> folder is self-contained, containing the <code>foo.cmajor</code> and <code>foo.cmajorpatch</code> files. The instrument can be executed using <code>cmaj play foo/foo.cmajorpatch</code> command and played with a MIDI device or possibly <a href="https://github.com/SoundStacks/cmajor/blob/main/docs/Cmaj%20Quick%20Start.md">converted as a JUCE plugin</a>.</p>
<h3 id="generating-the-cmajor-output-in-polyphonic-mode-with-a-global-effect">Generating the Cmajor output in polyphonic mode with a global effect</h3>
<p>DSP programs following the polyphonic <a href="../../manual/midi/#midi-polyphony-support">freq/gate/gain convention</a> with and an <a href="../../manual/midi/#audio-effects-and-polyphonic-synthesizer">integrated effect</a> can be generated using the <em>Platform = cmajor</em> and <em>Architecture = cmajor-poly-effect</em> export options. The resulting <em>foo</em> folder is self-contained, containing the <code>foo.cmajor</code> and <code>foo.cmajorpatch</code> files. The instrument can be executed using <code>cmaj play foo/foo.cmajorpatch</code> command and played with a MIDI device or possibly <a href="https://github.com/SoundStacks/cmajor/blob/main/docs/Cmaj%20Quick%20Start.md">converted as a JUCE plugin</a>.</p>
<h3 id="generating-the-cmajor-output-from-a-faust-dsp-program-found-in-the-web">Generating the Cmajor output from a Faust DSP program found in the web</h3>
<p>Faust DSP programs found on the Web can also be converted:</p>
<ul>
<li>
<p>for instance the <a href="https://faust.grame.fr/community/powered-by-faust/#fverb">fverb</a> listed on the <a href="https://faust.grame.fr/community/powered-by-faust/">Powered By Faust</a> page. The DSP content can simply be loaded using the <code>https://faustide.grame.fr/?code=URL</code> syntax, so
with the following URL: <a href="https://faustide.grame.fr/?code=https://raw.githubusercontent.com/jpcima/fverb/master/fverb.dsp">https://faustide.grame.fr/?code=https://raw.githubusercontent.com/jpcima/fverb/master/fverb.dsp</a>, tested in the Faust Web IDE, then converted in a Cmajor program as already showed</p>
</li>
<li>
<p>basic <a href="../../examples/ambisonics/">Examples</a> have been compiled to Cmajor <a href="rsrc/examples-cmajor.zip">here</a></p>
</li>
<li>
<p>examples of the <a href="https://faustplayground.grame.fr/">faustplayground</a> platform can be <a href="https://github.com/grame-cncm/faustplayground/tree/master/public/faust-modules">found here</a> and possibly converted. They have been compiled to Cmajor <a href="rsrc/faust-modules-cmajor.zip">here</a>.</p>
</li>
</ul>
<h2 id="experimental-faust-in-cmajor-integration">Experimental Faust in Cmajor integration</h2>
<p>With the release of the <a href="https://github.com/cmajor-lang/cmajor">Cmajor source code</a>, an experimental integration with Faust is now available, beginning with the <a href="https://github.com/cmajor-lang/cmajor/releases/tag/1.0.2616">Cmajor 1.0.2616 release</a>. This enables the creation of patches that merge Faust and Cmajor code. The <code>libfaust</code> component, which includes a Faust-to-Cmajor backend, is compiled as WebAssembly and dynamically used in the Faust DSP-to-Cmajor conversion process. The resulting Cmajor files are then JIT-compiled. See the <a href="https://github.com/cmajor-lang/cmajor/tree/main/examples/patches/FaustFM">FaustFM example</a>.</p>
<h3 id="known-limitations">Known limitations</h3>
<p>The Cmajor language generates some usefull API when the patch is exported in C++ or JavaScript. For example the  <code>getInputEndpoints/getOutputEndpoints</code> and <code>getEndpointHandle</code> functions allow an external piece of code to enumerate and access all endpoints, to possibly control the program or build a GUI. But unfortunately those functions <strong>are not part of the language itself</strong>. Thus there is no way we know of:</p>
<ul>
<li>
<p>to write a generic Cmajor program that would automatically connect some endpoints (assuming they would use some kind of MIDI describing metadata) to MIDI messages</p>
</li>
<li>
<p>to write a generic Cmajor program that would automatically wraps a voice generated from a Faust DSP program in a polyphonic and MIDI aware program, and expose the voice set of parameters at the main graph level, to be controlled globally for all voices</p>
</li>
</ul>
<p>We think the language would gain expressive power by having some kind of <a href="https://en.wikipedia.org/wiki/Reflective_programming">reflexivity</a>. </p></div>
        </div>
    </div>

    <footer class="col-md-12">
        <hr>
        <p>Copyright &copy; 2020-2025 <a href="https://www.grame.fr">Grame-CNCM</a></p>
    </footer>
    <script>
        var base_url = "../..",
        shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
    </script>
    <script src="../../js/base.js" defer></script>
    <script src="/js/faust-web-component.js" defer></script>
    <script src="../../search/main.js" defer></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
